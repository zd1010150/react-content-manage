/* 用于辅助生成前后端permission的对应关系，也就是config/app-permission.config.js */
const _ = require('lodash');

const formatPermissions = (permissionsFromRemote) => {
  const permissions = JSON.parse(permissionsFromRemote);
  const allPermissions = {};
  const convertIdTokey = id => id.replace(/-/g, '_').toUpperCase();
  const getId = (root) => {
    allPermissions[convertIdTokey(root.id)] = root.id;
    if (!_.isEmpty(root.child_rec)) {
      Object.keys(root.child_rec).forEach((t) => {
        getId(root.child_rec[t]);
      });
    }
  };
  Object.keys(permissions).forEach((t) => {
    getId(permissions[t]);
  });
  return allPermissions;
};
console.log(formatPermissions('{"Dashboard":{"id":"Dashboard","name":"\u542f\u52a8\u9879","child_rec":{"Add":{"id":"Dashboard-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Dashboard-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Dashboard-Update","name":"\u66f4\u65b0","child_rec":{}},"View":{"id":"Dashboard-View","name":"\u67e5\u770b","child_rec":{}}}},"Leads":{"id":"Leads","name":"\u6f5c\u5728\u5ba2\u6237","child_rec":{"Add":{"id":"Leads-Add","name":"\u65b0\u589e","child_rec":{}},"View":{"id":"Leads-View","name":"\u67e5\u770b","child_rec":{}},"Update":{"id":"Leads-Update","name":"\u66f4\u65b0","child_rec":{}},"Delete":{"id":"Leads-Delete","name":"\u5220\u9664","child_rec":{}},"CreateViewList":{"id":"Leads-CreateViewList","name":"\u521b\u5efa\u663e\u793a\u5217\u8868","child_rec":{}},"EditViewList":{"id":"Leads-EditViewList","name":"\u7f16\u8f91\u663e\u793a\u5217\u8868","child_rec":{}},"MassDelete":{"id":"Leads-MassDelete","name":"\u6279\u91cf\u5220\u9664","child_rec":{}},"MassUpdate":{"id":"Leads-MassUpdate","name":"\u6279\u91cf\u66f4\u65b0","child_rec":{}}}},"Accounts":{"id":"Accounts","name":"\u7528\u6237","child_rec":{"View":{"id":"Accounts-View","name":"\u67e5\u770b","child_rec":{}},"Update":{"id":"Accounts-Update","name":"\u66f4\u65b0","child_rec":{}},"Delete":{"id":"Accounts-Delete","name":"\u5220\u9664","child_rec":{}},"CreateViewList":{"id":"Accounts-CreateViewList","name":"\u521b\u5efa\u663e\u793a\u5217\u8868","child_rec":{}},"EditViewList":{"id":"Accounts-EditViewList","name":"\u7f16\u8f91\u663e\u793a\u5217\u8868","child_rec":{}},"MassDelete":{"id":"Accounts-MassDelete","name":"\u6279\u91cf\u5220\u9664","child_rec":{}},"MassUpdate":{"id":"Accounts-MassUpdate","name":"\u6279\u91cf\u66f4\u65b0","child_rec":{}}}},"Opportunities":{"id":"Opportunities","name":"\u673a\u4f1a","child_rec":{"View":{"id":"Opportunities-View","name":"\u67e5\u770b","child_rec":{}},"Update":{"id":"Opportunities-Update","name":"\u66f4\u65b0","child_rec":{}},"Delete":{"id":"Opportunities-Delete","name":"\u5220\u9664","child_rec":{}},"CreateViewList":{"id":"Opportunities-CreateViewList","name":"\u521b\u5efa\u663e\u793a\u5217\u8868","child_rec":{}},"EditViewList":{"id":"Opportunities-EditViewList","name":"\u7f16\u8f91\u663e\u793a\u5217\u8868","child_rec":{}},"MassDelete":{"id":"Opportunities-MassDelete","name":"\u6279\u91cf\u5220\u9664","child_rec":{}},"MassUpdate":{"id":"Opportunities-MassUpdate","name":"\u6279\u91cf\u66f4\u65b0","child_rec":{}}}},"Reports":{"id":"Reports","name":"\u62a5\u8868","child_rec":{"Add":{"id":"Reports-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Reports-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Reports-Update","name":"\u66f4\u65b0","child_rec":{}},"View":{"id":"Reports-View","name":"\u67e5\u770b","child_rec":{}}}},"Setup":{"id":"Setup","name":"\u8bbe\u7f6e","child_rec":{"CompanyProfile":{"id":"Setup-CompanyProfile","name":"\u516c\u53f8\u8d44\u6599","child_rec":{"CompanyInformation":{"id":"Setup-CompanyProfile-CompanyInformation","name":"\u516c\u53f8\u4fe1\u606f","child_rec":{"Update":{"id":"Setup-CompanyProfile-CompanyInformation-Update","name":"\u66f4\u65b0","child_rec":{}},"UpdateLogo":{"id":"Setup-CompanyProfile-CompanyInformation-UpdateLogo","name":"\u4e0a\u4f20Logo","child_rec":{}}}},"Users":{"id":"Setup-CompanyProfile-Users","name":"\u7528\u6237","child_rec":{"Add":{"id":"Setup-CompanyProfile-Users-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-CompanyProfile-Users-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-CompanyProfile-Users-Update","name":"\u66f4\u65b0","child_rec":{}}}},"OrganisationalChart":{"id":"Setup-CompanyProfile-OrganisationalChart","name":"\u7ec4\u7ec7\u7ed3\u6784","child_rec":{"Add":{"id":"Setup-CompanyProfile-OrganisationalChart-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-CompanyProfile-OrganisationalChart-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-CompanyProfile-OrganisationalChart-Update","name":"\u66f4\u65b0","child_rec":{}}}},"PermissionProfile":{"id":"Setup-CompanyProfile-PermissionProfile","name":"\u6743\u9650","child_rec":{"Update":{"id":"Setup-CompanyProfile-PermissionProfile-Update","name":"\u66f4\u65b0","child_rec":{}}}}}},"Leads":{"id":"Setup-Leads","name":"\u6f5c\u5728\u5ba2\u6237","child_rec":{"Fields":{"id":"Setup-Leads-Fields","name":"\u5b57\u6bb5","child_rec":{"Add":{"id":"Setup-Leads-Fields-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-Leads-Fields-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-Leads-Fields-Update","name":"\u66f4\u65b0","child_rec":{}}}},"PageLayout":{"id":"Setup-Leads-PageLayout","name":"\u9875\u9762\u8bbe\u7f6e","child_rec":{"Add":{"id":"Setup-Leads-PageLayout-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-Leads-PageLayout-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-Leads-PageLayout-Update","name":"\u66f4\u65b0","child_rec":{}},"Assign":{"id":"Setup-Leads-PageLayout-Assign","name":"\u5206\u914d","child_rec":{}}}}}},"Accounts":{"id":"Setup-Accounts","name":"\u7528\u6237","child_rec":{"Fields":{"id":"Setup-Accounts-Fields","name":"\u5b57\u6bb5","child_rec":{"Add":{"id":"Setup-Accounts-Fields-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-Accounts-Fields-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-Accounts-Fields-Update","name":"\u66f4\u65b0","child_rec":{}}}},"PageLayout":{"id":"Setup-Accounts-PageLayout","name":"\u9875\u9762\u8bbe\u7f6e","child_rec":{"Add":{"id":"Setup-Accounts-PageLayout-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-Accounts-PageLayout-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-Accounts-PageLayout-Update","name":"\u66f4\u65b0","child_rec":{}},"Assign":{"id":"Setup-Accounts-PageLayout-Assign","name":"\u5206\u914d","child_rec":{}}}}}},"Opportunities":{"id":"Setup-Opportunities","name":"\u673a\u4f1a","child_rec":{"Fields":{"id":"Setup-Opportunities-Fields","name":"\u5b57\u6bb5","child_rec":{"Add":{"id":"Setup-Opportunities-Fields-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-Opportunities-Fields-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-Opportunities-Fields-Update","name":"\u66f4\u65b0","child_rec":{}}}},"PageLayout":{"id":"Setup-Opportunities-PageLayout","name":"\u9875\u9762\u8bbe\u7f6e","child_rec":{"Add":{"id":"Setup-Opportunities-PageLayout-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-Opportunities-PageLayout-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-Opportunities-PageLayout-Update","name":"\u66f4\u65b0","child_rec":{}},"Assign":{"id":"Setup-Opportunities-PageLayout-Assign","name":"\u5206\u914d","child_rec":{}}}}}},"EmailCommunications":{"id":"Setup-EmailCommunications","name":"\u90ae\u4ef6","child_rec":{"EmailTemplates":{"id":"Setup-EmailCommunications-EmailTemplates","name":"\u90ae\u4ef6\u6a21\u677f","child_rec":{"View":{"id":"Setup-EmailCommunications-EmailTemplates-View","name":"\u67e5\u770b","child_rec":{}},"Add":{"id":"Setup-EmailCommunications-EmailTemplates-Add","name":"\u65b0\u589e","child_rec":{}},"Delete":{"id":"Setup-EmailCommunications-EmailTemplates-Delete","name":"\u5220\u9664","child_rec":{}},"Update":{"id":"Setup-EmailCommunications-EmailTemplates-Update","name":"\u66f4\u65b0","child_rec":{}},"Assign":{"id":"Setup-EmailCommunications-EmailTemplates-Assign","name":"\u5206\u914d","child_rec":{}},"EditMyFolders":{"id":"Setup-EmailCommunications-EmailTemplates-EditMyFolders","name":"\u7f16\u8f91\u6587\u4ef6\u5939","child_rec":{}}}}}}}}}'));
// export default formatPermissions;
